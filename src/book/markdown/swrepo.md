## BPKs and Software repository {#user.swrepository}

### Been package (BPK) {#user.swrepository.bpk}
Been package, shortly BPK, contains binaries and descriptors needed to run tasks, task contexts and benchmarks.
Each package has its own unique identifier with structure similar to identifiers used by Maven. The identifier consists of three parts: 

1. **Group ID** -  	A universally unique identifier for a BPK. It is a good practice to use a fully-qualified package name to distinguish it from other BPK packages with a similar name (eg. cz.been.example).
2. **Bpk ID** - The identifier of the BPK that is unique within the group given by the group ID.
3. **Version** - The current version of the BPK.

BPK package is represented by single file with **\*.bpk** suffix. In fact the bpk file is a zip file with predefined structure described below.

    package.bpk
       \___ config.xml
       \___ files/
       \___ lib/
       \___ tcds/
       \___ tds/


1. ***config.xml*** file - Main configuration XML descriptor of the BPK. It consists of two main sections:
    - **metaInf** section - specifies unique identifier of the BPK. 
    - **runtime** section - specifies runtime type. Been supports two runtime types - **JavaRuntime** and **NativeRuntime**. 
        - **JavaRuntime** - defines tasks written in JVM based language (e.g. Java, Scale, Groovy). The name of the jar with implementation is required.
        - **NativeRuntime** - defines tasks written in other languages. This type requires the name of a runnable object (binary or script) to be used.

    Following examples show valid descriptors for *java* and *native* runtimes.

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns2:bpkConfiguration xmlns:ns2="http://been.d3s.mff.cuni.cz/bpk/config">

    <ns2:metaInf>
        <groupId>fully-quallified.group.id</groupId>
        <bpkId>bpkId</bpkId>
        <version>3.0.0-EXAMPLE-ALPHA</version>
    </ns2:metaInf>
    
    <ns2:runtime xsi:type="ns2:JavaRuntime"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <jarFile>packed_jar_with_tasks.jar</jarFile>
    </ns2:runtime>
    
</ns2:bpkConfiguration>
```


```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<ns2:bpkConfiguration xmlns:ns2="http://been.d3s.mff.cuni.cz/bpk/config">

    <ns2:metaInf>
        <groupId>fully-quallified.group.id</groupId>
        <bpkId>bpkId</bpkId>
        <version>3.0.0-EXAMPLE-ALPHA</version>
    </ns2:metaInf>
    
    <ns2:runtime xsi:type="ns2:NativeRuntime"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        <binary>name_of_executable</binary>
    </ns2:runtime>
            
</ns2:bpkConfiguration>
```

2. ***files/*** directory - contains runnable objects of a task(s). In the case of the ***JavaRuntime***  it must contain the jar with implementation, ***NativeRuntime***s must place its runnable objects there. 

3. ***lib/*** directory - ***JavaRuntime***s can place additional jars which will be added to the `classpath` of a task once running on a Host Runtime. 

4. ***tcds/*** directory - should contain any Task Context descriptors in order to be recognized by the Web Interface.

5. ***tds/*** directory - should contain at least one Task descriptor.


When a task is started, *lib/*, *files*, *tds/* and *tcds/* directories are copied into the working directory of the task.

Even though it is possible to create a BPK "by hand" it is not recommended. The standard way of assembling a BPK file is to use use the [Been Bpk Plugin](#user.bpkplugin) which does all the hard work.

**Note:** You can see more elements in *context.xml* file generated by [Been BPK plugin](#user.bpkplugin) and you can also find definitions of these elements in corresponding \*.xsd file, but these elements are not used in the current version. 


### Software repository {#user.swrepository.swrepository}
The main purpose of the software repository is to store BPKs for future use. The Software Repository is implemented as a service which can be started on an arbitrary EverBEEN node.

### BPK versioning {#user.swrepository.bpkversioning}
Software repository does not allow re-uploading of BPKs with same `groupId`, `bpkId` and `version`. If you want to re-upload a BPK, you have to change its version. The reason for this limitation is simple - it prevents inconsistencies and unpredictable behavior of production code.

For ease of developing of new tasks and benchmarks BPKs can be created with version suffixed by **'-SNAPSHOT'**. Such versions of BPKs can be re-uploaded to the Software Repository. Also Host Runtimes will download such versions instead of using cached packages. It is not recommended to use **'-SNAPSHOT'** in production environment. 